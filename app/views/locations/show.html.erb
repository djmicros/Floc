<% provide(:title, @location.name) %>
<script src="//maps.google.com/maps/api/js?v=3.13&amp;sensor=false&amp;libraries=geometry" type="text/javascript"></script>
<script src='//google-maps-utility-library-v3.googlecode.com/svn/tags/markerclustererplus/2.0.14/src/markerclusterer_packed.js' type='text/javascript'></script>

<div class="row">

 <section>
      <h1>
        <%#= @location.photos.first.photo.url %>
      </h1>
		Photos:
		<% @location.photos.each do |pic| %>
			<%= image_tag pic.photo.url %>
		<% end %>
	  </br>
		Tags:
		<%= raw @location.tag_list.map { |t| link_to t, tag_path(t)}.join(', ')%>
	  </br>
		User:
		<%= @location.photos.first.photo.url %>
		<%= @location.user.name %>
		<%= @location.latitude %>
		<%= @location.longitude %>
	  </br>
		<h4>Nearby:</h4>
			<ul>
			<% for location in @location.nearbys(5) %>
				<li><%= link_to location.name, location %> (<%=location.distance.round(2) %> miles)</li>
			<% end %>
			</ul>
	  </br>
		<h4>Map:</h4>
			<div>
			  <div id="location_map" style='width: 800px; height: 400px;'></div>
			</div> 

</div>



	<script> 

		handler = Gmaps.build('Google');
		handler.buildMap({ internal: {id: 'location_map'}}, function(){
		  markers = handler.addMarkers(<%=raw @hash.to_json %>);
		handler.bounds.extendWith(markers);
		handler.fitMapToBounds();
		});

		    
	</script>


